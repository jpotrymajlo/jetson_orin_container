services:
  dev_container:
    build:
      context: .
      args:
        DOCKER_USER: ${DOCKER_USER}
        DOCKER_HOME: ${DOCKER_HOME}
        DOCKER_UID: ${DOCKER_UID}
        DOCKER_GID: ${DOCKER_GID}
        DISPLAY: ${DISPLAY}

    entrypoint: [bash, "/tmp/install/entrypoint.sh"]
    volumes:
        - ${HOME}/projects:${DOCKER_HOME}/projects:rw
        - ${HOME}/.ssh:${DOCKER_HOME}/.ssh:rw
        - ${HOME}/.local_docker:${DOCKER_HOME}/.local:rw
        - ${HOME}/.vscode-server-docker:${DOCKER_HOME}/.vscode-server:rw
        - ${HOME}/.conan2-docker:${DOCKER_HOME}/.conan2:rw
        - ${PWD}/init_scripts/:/tmp/install:ro
        - /tmp/.X11-unix:/tmp/.X11-unix:rw
    environment:
        - DISPLAY=${DISPLAY}
        - DOCKER_HOME=${HOME}
        - DOCKER_USER=${USER}
    ports:
        - 22222:22

